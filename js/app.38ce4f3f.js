(function(){"use strict";var e={1584:function(e,t,r){var s,n=r(144),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"section",attrs:{id:"app"}},[r("div",{staticClass:"container"},[r("SchemaSection"),r("QueryWrapper")],1)])},i=[],o=r(655),u=r(1929),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"field"},[r("SchemaIdInput"),r("ShExCView"),"INVALID"===e.parseStatus?r("div",[r("ShExCErrors")],1):e._e()],1)},l=[],h=r(629),d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("label",{staticClass:"label",attrs:{for:"SchmeaIdInput"}},[e._v(" EntitySchema ID ")]),r("div",{class:e.controlClass},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.SchemaId,expression:"SchemaId"}],class:e.inputClass,attrs:{id:"SchmeaIdInput",type:"url",placeholder:"E123"},domProps:{value:e.SchemaId},on:{change:e.ShExChanged,input:function(t){t.target.composing||(e.SchemaId=t.target.value)}}}),e.hasIcon?r("ShExCStatusIcon"):e._e()],1)])},m=[];(function(e){e["none"]="NONE",e["loading"]="LOADING",e["loadingError"]="LOADING_ERROR",e["inProgress"]="IN_PROGRESS",e["valid"]="VALID",e["invalid"]="INVALID"})(s||(s={}));var p,f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",{class:e.wrapperClass},[r("i",{class:e.iconClass})])},E=[],S={name:"ShExCStatusIcon",computed:{wrapperClass(){const e=["icon","is-small","is-right"];switch(this.$store.getters.getShExCStatus){case s.invalid:case s.loadingError:e.push("has-text-danger");break;case s.valid:e.push("has-text-success");break;default:throw new Error("Invalid status for icon: "+this.$store.getters.getShExCStatus)}return e.join(" ")},iconClass(){const e=["fas"];switch(this.$store.getters.getShExCStatus){case s.invalid:case s.loadingError:e.push("fa-times");break;case s.valid:e.push("fa-check");break;default:throw new Error("Invalid status for icon: "+this.$store.getters.getShExCStatus)}return e.join(" ")}}},g=S,v=r(1001),y=(0,v.Z)(g,f,E,!1,null,"29569010",null),C=y.exports,x={name:"SchemaIdInput",components:{ShExCStatusIcon:C},data(){const e=this.$route.query;if(e.schemaURL){const t=e.schemaURL.substring(e.schemaURL.lastIndexOf("E"));return this.updateSchemaId(t),{SchemaId:t}}return e.schemaId?(this.updateSchemaId(e.schemaId),{SchemaId:e.schemaId}):{SchemaId:""}},computed:{inputClass(){let e="input";switch(this.$store.getters.getShExCStatus){case s.none:case s.loading:break;case s.invalid:case s.loadingError:e+=" is-danger";break;case s.valid:e+=" is-success";break;case s.inProgress:e+="is-warning";break;default:throw new Error("Unknown parse status: "+this.$store.getters.getShExCStatus)}return e},controlClass(){let e="control";switch(this.$store.getters.getShExCStatus){case s.none:case s.inProgress:break;case s.loading:e+=" is-loading";break;case s.invalid:case s.loadingError:case s.valid:e+=" has-icons-right";break;default:throw new Error("Unknown parse status: "+this.$store.getters.getShExCStatus)}return e},hasIcon(){return[s.loadingError,s.valid,s.invalid].includes(this.$store.getters.getShExCStatus)}},methods:{...(0,h.nv)({updateSchemaId:"updateSchemaId"}),ShExChanged(){this.updateSchemaId(this.SchemaId)}}},b=x,w=(0,v.Z)(b,d,m,!1,null,"68645a8b",null),I=w.exports,Q=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("pre",[e._v(e._s(e.$store.state.ShExC))])},_=[],P={name:"ShExCView"},k=P,O=(0,v.Z)(k,Q,_,!1,null,"063fcbd3",null),R=O.exports,N=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.error.message?r("div",{staticClass:"notification is-danger"},[r("b",[e._v("Line "+e._s(e.error.lineNo)+":")]),r("pre",[e._v(e._s(e.error.message))])]):e._e()},$=[],j={name:"ShExCErrors",computed:{...(0,h.Se)({error:"getShExCParseError"})}},L=j,Z=(0,v.Z)(L,N,$,!1,null,"69312442",null),q=Z.exports,U={name:"SchemaSection",components:{SchemaIdInput:I,ShExCView:R,ShExCErrors:q},computed:{...(0,h.Se)({parseStatus:"getShExCStatus"})}},T=U,V=(0,v.Z)(T,c,l,!1,null,"1d6173ce",null),A=V.exports,D=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("QueryInput"),e.numEntities>0?r("QueryResult"):e._e()],1)},M=[],F=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"field"},[r("label",{staticClass:"label",attrs:{for:"query"}},[e._v("SPARQL Query")]),r("p",{staticClass:"help"},[e._v("Enter query for Items to check.")]),r("div",{staticClass:"control"},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.Query,expression:"Query"}],staticClass:"textarea",attrs:{id:"query",rows:"10",spellcheck:"false",autocomplete:"off","data-gramm":"false",autocapitalize:"none",cols:"72",name:"query",placeholder:"#Cats\nSELECT ?item\nWHERE\n{\n  ?item wdt:P31 wd:Q146.\n}"},domProps:{value:e.Query},on:{input:function(t){t.target.composing||(e.Query=t.target.value)}}})]),r("div",{staticClass:"control"},[r("button",{staticClass:"button is-primary",on:{click:e.handleQueryChange}},[e._v(" Fetch Entites ")])]),e.getQueryError?r("div",{staticClass:"notification is-danger"},[r("pre",[e._v(e._s(e.getQueryError))])]):e._e()])},W=[],G={name:"QueryInput",data(){return{Query:""}},computed:{...(0,h.Se)({parseStatus:"getShExCStatus",getQueryError:"getQueryError"})},methods:{handleQueryChange(){this.updateQueryInStore(this.Query)},...(0,h.nv)({updateQueryInStore:"setQuery"})}},Y=G,z=(0,v.Z)(Y,F,W,!1,null,"01b2cb1a",null),B=z.exports,H=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("ul",{staticClass:"list"},e._l(e.entities,(function(e){return r("EntityListItem",{key:e.url,attrs:{status:e.status,url:e.url,error:e.error}})})),1)])},J=[],K=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"list-item"},[r("a",{staticClass:"is-success",attrs:{href:e.url}},[e._v(e._s(e.url))]),e.isConformant?r("span",{staticClass:"tag is-success"},[e._v(e._s(e.status))]):e._e(),e.hasErrors?r("span",{staticClass:"tag is-danger"},[e._v(e._s(e.status))]):e._e(),e.hasErrors?r("pre",[e._v(e._s(e.error))]):e._e()])},X=[];(function(e){e["Conformant"]="CONFORMANT",e["Nonconformant"]="NONCONFORMANT"})(p||(p={}));var ee={name:"EntityListItem",props:{url:{type:String,required:!0},status:p,error:{type:String,default:""}},computed:{hasErrors(){return this.status===p.Nonconformant},isConformant(){return this.status===p.Conformant}}},te=ee,re=(0,v.Z)(te,K,X,!1,null,"3eca5e9a",null),se=re.exports,ne={name:"QueryResult",components:{EntityListItem:se},computed:{...(0,h.Se)({entities:"getQueryEntities"})}},ae=ne,ie=(0,v.Z)(ae,H,J,!1,null,"15988f90",null),oe=ie.exports,ue={name:"QueryWrapper",components:{QueryResult:oe,QueryInput:B},computed:{...(0,h.Se)({numEntities:"getQueryEntitiesLength"})}},ce=ue,le=(0,v.Z)(ce,D,M,!1,null,"218864b4",null),he=le.exports;let de=class extends u.w3{};de=(0,o.gn)([(0,u.wA)({components:{QueryWrapper:he,SchemaSection:A}})],de);var me=de,pe=me,fe=(0,v.Z)(pe,a,i,!1,null,null,null),Ee=fe.exports;function Se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ge{constructor(e){Se(this,"entities",void 0),this.entities=e}}var ve=ge;function ye(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ce{constructor(){ye(this,"QUERY_URL","https://query.wikidata.org/sparql?format=json&query=")}async fetchItems(e){const t=await fetch(this.QUERY_URL+encodeURIComponent(e.query)).then((async e=>{if(200!==e.status){const t=await e.text(),r=t.split("\n").filter((e=>e.includes("MalformedQueryException")));if(r.length)throw Error(r[0]);throw Error(t)}return e.json()})).then((e=>e));return new ve(this.parseItemsFromResponse(t))}parseItemsFromResponse(e){if(0===e.results.bindings.length)return[];const t=e.results.bindings;return t.map((e=>{for(const t in e)if("uri"===e[t].type&&e[t].value.match(/http(s?):\/\/www.wikidata.org\/entity\//))return e[t].value}))}}var xe=Ce;function be(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class we{constructor(e){be(this,"query",void 0),this.query=e}}var Ie=we,Qe=r(8971);function _e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Pe{constructor(e,t){_e(this,"status",void 0),_e(this,"errorMessage",void 0),this.status=e,this.errorMessage=t}}function ke(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Oe{constructor(e){ke(this,"endpoint",void 0),this.endpoint=e}async validate(e){const t=Qe.Util.makeQueryDB(this.endpoint);return new Promise((r=>{const s=Qe.Validator.construct(e.parsedSchema,{results:"api"}).validate(t,[{node:e.entityUrl,shape:Qe.Validator.start}]);r(s)})).then(this.buildResponseFromValidationResult.bind(this)).catch((e=>new Pe(p.Nonconformant,e)))}buildResponseFromValidationResult(e){return new Pe(this.getResultStatus(e[0]),this.getResultErrors(e[0]))}getResultStatus(e){return"conformant"===e.status?p.Conformant:p.Nonconformant}getResultErrors(e){return"conformant"===e.status?"":Qe.Util.errsToSimple(e.appinfo).join("\n")}}function Re(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ne{constructor(e,t,r){Re(this,"entityId",void 0),Re(this,"entityUrl",void 0),Re(this,"parsedSchema",void 0),this.parsedSchema=e,this.entityId=t,this.entityUrl=r}}var $e=r(9210),je=r.n($e);function Le(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ze{constructor(e,t){Le(this,"parsedSchema",void 0),Le(this,"error",null),this.parsedSchema=e,t&&(this.error={message:t.message,lineNo:t.lineNo})}}var qe=Ze;Error.captureStackTrace=()=>null;class Ue{parse(e){const t=e.getText();function r(e,t){const r=je().construct(""),s=r.parse(e);return t.base="",t.prefixes=s.prefixes||{},s}const s={};try{const e=r(t,s);return new qe(e,null)}catch(n){return new qe(null,n)}}}var Te=Ue;function Ve(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ae{constructor(e){Ve(this,"text",void 0),this.text=e}getText(){return this.text}}var De=Ae,Me=r(2043),Fe=r(8345);const We=new Fe.Z({mode:"history",routes:[]});var Ge=We,Ye={setQuery({commit:e,state:t},r){e("setQuery",{query:r}),e("setQueryEntities",{entities:{}}),e("setQueryError","");const s=new xe;s.fetchItems(new Ie(r)).then((t=>{e("setQueryEntities",{entities:t.entities.reduce(((e,t)=>{const r=t.match(/[QPL]\d+/);return null!==r&&r[0]?(e[r[0]]={url:t},e):(Me.warn("unexpected match for",t,r),e)}),{})})})).then((async()=>{if(0===Object.keys(t.QueryEntities).length)return;if(0!==t.ShExCParseError.message.length)return;const r=new Oe("https://query.wikidata.org/sparql");for(const[s,{url:n}]of Object.entries(t.QueryEntities)){const a=await r.validate(new Ne(t.ShemaParsed,s,n));e("setEntityData",{id:s,status:a.status,error:a.errorMessage})}})).catch((t=>{e("setQueryError",t)}))},updateSchemaId({commit:e},t){if(!t.match(/^E[1-9]\d*$/))return void e("setShExCStatus",s.loadingError);Ge.push({query:{schemaId:t}}),e("setShExCStatus",s.loading);const r="https://www.wikidata.org/wiki/Special:EntitySchemaText/"+t;fetch(r).then((e=>e.text()),(t=>{throw e("setShExCStatus",s.loadingError),t})).then((t=>{e("setShExCStatus",s.inProgress),e("setShExCText",t);const r=new Te,n=r.parse(new De(t));n.error?(e("setShExCStatus",s.invalid),e("setShExCError",{errorMessage:n.error.message,lineNo:n.error.lineNo}),e("setParsedSchema",{})):(e("setShExCStatus",s.valid),e("clearShExCError"),e("setParsedSchema",n.parsedSchema))})).catch((e=>Me.error(e)))}};n.Z.use(h.ZP);var ze=new h.ZP.Store({state:{Query:"",QueryEntities:{},QueryError:"",ShemaParsed:{},ShExC:"",ShExCStatus:s.none,ShExCParseError:{message:"",lineNo:-1}},getters:{getShExCStatus(e){return e.ShExCStatus},getShExCParseError(e){return e.ShExCParseError},getQueryError(e){return e.QueryError},getQueryEntities(e){return e.QueryEntities},getQueryEntitiesLength(e){return Object.keys(e.QueryEntities).length}},mutations:{setQuery(e,t){e.Query=t.query},setQueryEntities(e,t){e.QueryEntities=t.entities},setQueryError(e,t){e.QueryError=t},setEntityData(e,t){e.QueryEntities[t.id]={...e.QueryEntities[t.id],status:t.status,error:t.error}},setShExCStatus(e,t){e.ShExCStatus=t},setShExCError(e,{errorMessage:t,lineNo:r}){e.ShExCParseError={message:t,lineNo:r}},setShExCText(e,t){e.ShExC=t},setParsedSchema(e,t){e.ShemaParsed=t},clearShExCError(e){e.ShExCParseError={message:"",lineNo:-1}}},actions:Ye});n.Z.config.productionTip=!1,n.Z.use(Fe.Z),new n.Z({router:Ge,store:ze,render:e=>e(Ee)}).$mount("#app")}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var a=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}r.m=e,function(){var e=[];r.O=function(t,s,n,a){if(!s){var i=1/0;for(l=0;l<e.length;l++){s=e[l][0],n=e[l][1],a=e[l][2];for(var o=!0,u=0;u<s.length;u++)(!1&a||i>=a)&&Object.keys(r.O).every((function(e){return r.O[e](s[u])}))?s.splice(u--,1):(o=!1,a<i&&(i=a));if(o){e.splice(l--,1);var c=n();void 0!==c&&(t=c)}}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[s,n,a]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,a,i=s[0],o=s[1],u=s[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(n in o)r.o(o,n)&&(r.m[n]=o[n]);if(u)var l=u(r)}for(t&&t(s);c<i.length;c++)a=i[c],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(l)},s=self["webpackChunkwikidatashexvalidator"]=self["webpackChunkwikidatashexvalidator"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=r.O(void 0,[998],(function(){return r(1584)}));s=r.O(s)})();
//# sourceMappingURL=app.38ce4f3f.js.map